{"version":3,"sources":["webpack:///C:/Users/MEEA/Downloads/SAG/presales/Angular/projects/gp-kpi-overview-widget/src/lib/gp-kpi-overview-widget.service.ts","webpack:///C:/Users/MEEA/Downloads/SAG/presales/Angular/projects/gp-kpi-overview-widget/src/lib/gp-kpi-overview-widget.component.ts","webpack:///C:/Users/MEEA/Downloads/SAG/presales/Angular/projects/gp-kpi-overview-widget/src/lib/gp-kpi-overview-widget-config/gp-kpi-overview-widget-config.component.ts","webpack:///C:/Users/MEEA/Downloads/SAG/presales/Angular/projects/gp-kpi-overview-widget/src/lib/color-picker/color-picker-component.ts","webpack:///C:/Users/MEEA/Downloads/SAG/presales/Angular/projects/gp-kpi-overview-widget/src/lib/color-picker/color-slider/color-slider-component.ts","webpack:///C:/Users/MEEA/Downloads/SAG/presales/Angular/projects/gp-kpi-overview-widget/src/lib/color-picker/color-palette/color-palette-component.ts","webpack:///C:/Users/MEEA/Downloads/SAG/presales/Angular/projects/gp-kpi-overview-widget/src/lib/gp-kpi-overview-widget.module.ts"],"names":["inventory","childDevice","childDeviceData","assetChildDevice","assetChildDeviceData","available","firmwareData","risks","firmwareStatus","version","alerts","activeAlerts","critical","kpiService","this","kpi","title","kpiName","icon","message","default","color","bgcolor","titleColor","unitColor","messageColor","_.get","config","w","widgetElement","widgetTitleDisplayValue","result","reader","_.set","eRef","rgba","toString","r","g","b","a","ctx","gradient","addColorStop","whiteGrad","blackGrad","pos"],"mappings":"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","file":"kpi-overview-runtime-widget-CustomWidget.e45db875201eb775e4c1.js","sourcesContent":["/**\n * Copyright (c) 2020 Software AG, Darmstadt, Germany and/or its licensors\n *\n * SPDX-License-Identifier: Apache-2.0\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { ThrowStmt } from '@angular/compiler';\nimport { Injectable } from '@angular/core';\nimport { InventoryService } from '@c8y/client';\n\n\n@Injectable()\nexport class GpKpiOverviewWidgetService {\n  latestFirmwareVersion: any;\n\n\n  constructor(public inventory: InventoryService) {\n  }\n\n  async getDevicesAvailability(deviceId){\n    let totalDevices = 0;\n    let availableDevices = 0;\n    let unavailableDevices = 0;\n      let response: any = null;\n      const inventory = await this.inventory.detail(deviceId);\n      response = inventory.data;\n      if (response.hasOwnProperty('c8y_IsDevice')) {\n        totalDevices = 1;\n\n        if (response.childDevices.references.length > 0) {\n\n          let available = false;\n          const promises = response.childDevices.references.map(async (childDevice) => {\n            const childInventory = await this.inventory.detail(childDevice.managedObject.id);\n            const childDeviceData = childInventory.data;\n\n            if (childDeviceData.hasOwnProperty('c8y_Availability')){\n\n              if (childDeviceData.c8y_Availability.status === 'AVAILABLE') {\n                available = true;\n              } else {\n                  available = false;\n              }\n            }\n          });\n          if(available){\n            if (response.hasOwnProperty('c8y_Availability')) {\n              if (response.c8y_Availability.status === 'AVAILABLE') {\n                availableDevices = 1;\n              }\n              else{\n                unavailableDevices = 1;\n              }\n            }else{\n              availableDevices = 1;\n            }\n          }\n          else{\n            unavailableDevices = 1;\n          }\n          await Promise.all(promises);\n        } else {\n          if (response.hasOwnProperty('c8y_Availability') && (response.c8y_Availability.status === 'AVAILABLE')) {\n            availableDevices = 1;\n          }\n          else{\n            unavailableDevices = 1;\n          }\n        }\n      }\n        else {\n          if (response.childAssets.references.length > 0) {\n            const promises = response.childAssets.references.map(async (childDevice) => {\n              const ChildInventory = await this.inventory.detail(childDevice.managedObject.id);\n              const childDeviceData = ChildInventory.data;\n              if (childDeviceData.hasOwnProperty('c8y_Availability')) {\n                if (childDeviceData.c8y_Availability.status === 'AVAILABLE') {\n                  availableDevices += 1;\n                }\n                else{\n                  unavailableDevices += 1;\n                }\n              }\n              else if(childDeviceData.hasOwnProperty('c8y_IsAsset')){\n                let available = false;\n                if (childDeviceData.childAssets.references.length > 0) {\n                  const promises1 = childDeviceData.childAssets.references.map(async (assetChildDevice) => {\n                    const assetChildInventory = await this.inventory.detail(assetChildDevice.managedObject.id);\n                    const assetChildDeviceData = assetChildInventory.data;\n                    if (assetChildDeviceData.hasOwnProperty('c8y_Availability')){\n\n                      if (assetChildDeviceData.c8y_Availability.status === 'AVAILABLE') {\n                        available = true;\n                    } else {\n                        available = false;\n                    }\n                    }\n                    else{\n                      available = false;\n                    }\n                  });\n                  await Promise.all(promises1);\n                }\n                if (available) {\n                  availableDevices += 1;\n                }else{\n                  unavailableDevices += 1;\n                }\n              }\n            });\n            await Promise.all(promises);\n          }\n          totalDevices = inventory.data.childAssets.references.length;\n        }\n        return {totalDevices, availableDevices, unavailableDevices};\n    }\n\n  async getFirmwareRisks(deviceId){\n    let highRiskCount = 0;\n    let mediumRiskCount = 0;\n    let lowRiskCount = 0;\n    let noRiskCount = 0;\n    const firmwareData = await this.inventory.list({ type: 'sag_racm_currentFirmware' });\n    if (firmwareData.data.length > 0) {\n    this.latestFirmwareVersion = firmwareData.data[0].firmware.version;\n    }\n    let response: any = null;\n    const inventory = await this.inventory.detail(deviceId);\n    response = inventory.data;\n    if (response.hasOwnProperty('c8y_IsDevice')) {\n      const risks = this.calculateRiskCount(response);\n      highRiskCount = risks.highRisk;\n      mediumRiskCount = risks.mediumRisk;\n      lowRiskCount = risks.lowRisk;\n      noRiskCount = risks.noRisk;\n    }\n    else if(response.childAssets.references.length > 0){\n\n      const promises = response.childAssets.references.map(async (childDevice) => {\n        const childInventory = await this.inventory.detail(childDevice.managedObject.id);\n        const childDeviceData = childInventory.data;\n        if (childDeviceData.hasOwnProperty('c8y_IsDevice')) {\n          const risks = this.calculateRiskCount(response);\n          highRiskCount = risks.highRisk;\n          mediumRiskCount = risks.mediumRisk;\n          lowRiskCount = risks.lowRisk;\n          noRiskCount = risks.noRisk;        }\n        else if(childDeviceData.hasOwnProperty('c8y_IsAsset')){\n          if (childDeviceData.childAssets.references.length > 0) {\n            const promises1 = childDeviceData.childAssets.references.map(async (assetChildDevice) => {\n            const assetChildInventory = await this.inventory.detail(assetChildDevice.managedObject.id);\n            const assetChildDeviceData = assetChildInventory.data;\n            if (assetChildDeviceData.hasOwnProperty('c8y_IsDevice')) {\n              const risks = this.calculateRiskCount(response);\n              highRiskCount = risks.highRisk;\n              mediumRiskCount = risks.mediumRisk;\n              lowRiskCount = risks.lowRisk;\n              noRiskCount = risks.noRisk;            }\n            });\n            await Promise.all(promises1);\n          }\n        }\n      });\n      await Promise.all(promises);\n    }\n    return {highRiskCount, mediumRiskCount, lowRiskCount, noRiskCount};\n  }\n\n  calculateRiskCount(device){\n    let atRisk = false;\n    let noRisk = 0;\n    let lowRisk = 0;\n    let mediumRisk = 0;\n    let highRisk = 0;\n\n    if (device) {\n       const firmwareStatus = device.c8y_Firmware;\n       let versionIssues = 0;\n       if (firmwareStatus  && firmwareStatus.version) {\n         versionIssues = firmwareStatus.version - this.latestFirmwareVersion;\n        }\n       if (versionIssues <= 0) {\n          atRisk = true; }\n       if ( atRisk) {\n            if (atRisk) {\n              if (versionIssues >= 0) {\n                noRisk += 1;\n              } else if (versionIssues === -1) {\n                lowRisk += 1;\n              } else if (versionIssues === -2) {\n                mediumRisk += 1;\n              } else if (versionIssues <= -3) {\n                highRisk += 1;\n              }\n            }\n        }\n      }\n      return {noRisk, lowRisk, mediumRisk, highRisk}\n  }\n  async getAlarms(deviceId){\n    let totalAlarms = 0;\n    let majorAlertsCount = 0;\n    let minorAlertsCount = 0;\n    let criticalAlertsCount = 0;\n    let response: any = null;\n    const inventory = await this.inventory.detail(deviceId);\n    response = inventory.data;\n\n    if (response.hasOwnProperty('c8y_IsDevice')) {\n      const alerts = this.calculateAlarmsCount(response);\n      minorAlertsCount = alerts.minorAlerts;\n      majorAlertsCount = alerts.majorAlerts;\n      criticalAlertsCount = alerts.criticalAlerts;\n    }\n    else if(response.childAssets.references.length > 0){\n      const promises = response.childAssets.references.map(async (childDevice) => {\n        const childInventory = await this.inventory.detail(childDevice.managedObject.id);\n        const childDeviceData = childInventory.data;\n        if (childDeviceData.hasOwnProperty('c8y_IsDevice')) {\n          const alerts = this.calculateAlarmsCount(childDeviceData);\n          minorAlertsCount = alerts.minorAlerts;\n          majorAlertsCount = alerts.majorAlerts;\n        criticalAlertsCount = alerts.criticalAlerts;\n        }\n        else if(childDeviceData.hasOwnProperty('c8y_IsAsset')){\n          if (childDeviceData.childAssets.references.length > 0) {\n            const promises1 = childDeviceData.childAssets.references.map(async (assetChildDevice) => {\n            const assetChildInventory = await this.inventory.detail(assetChildDevice.managedObject.id);\n            const assetChildDeviceData = assetChildInventory.data;\n            if (assetChildDeviceData.hasOwnProperty('c8y_IsDevice')) {\n              const alerts = this.calculateAlarmsCount(assetChildDeviceData);\n              minorAlertsCount = alerts.minorAlerts;\n              majorAlertsCount = alerts.majorAlerts;\n              criticalAlertsCount = alerts.criticalAlerts;\n            }\n            });\n            await Promise.all(promises1);\n          }\n        }\n      });\n      await Promise.all(promises);\n    }\n    totalAlarms = majorAlertsCount + minorAlertsCount + criticalAlertsCount;\n    return {totalAlarms, majorAlertsCount, minorAlertsCount, criticalAlertsCount};\n  }\n\n\n  calculateAlarmsCount(device){\n    let minorAlerts = 0;\n    let majorAlerts = 0;\n    let criticalAlerts = 0;\n    const activeAlerts = device.c8y_ActiveAlarmsStatus;\n    if (activeAlerts !== undefined) {\n          if (activeAlerts.hasOwnProperty('minor')) {\n            if (activeAlerts.minor > 0) { minorAlerts += device.c8y_ActiveAlarmsStatus.minor; }\n          }\n          if (activeAlerts.hasOwnProperty('major')) {\n           if (activeAlerts.major > 0) { majorAlerts += device.c8y_ActiveAlarmsStatus.major }\n         }\n          if (activeAlerts.hasOwnProperty('critical')) {\n           if (activeAlerts.critical > 0) { criticalAlerts += device.c8y_ActiveAlarmsStatus.critical }\n         }\n        }\n        return {minorAlerts, majorAlerts, criticalAlerts}\n  }\n\n  async getNewKPICount(deviceId, newKPI){\n    let newKPICount = 0;\n    let response: any = null;\n    const inventory = await this.inventory.detail(deviceId);\n    response = inventory.data;\n    if (response.hasOwnProperty('c8y_IsDevice') && response.hasOwnProperty(newKPI)) {\n      newKPICount = 1;\n    }\n    else if(response.childAssets.references.length > 0){\n      const promises = response.childAssets.references.map(async (childDevice) => {\n        const childInventory = await this.inventory.detail(childDevice.managedObject.id);\n        const childDeviceData = childInventory.data;\n        if (childDeviceData.hasOwnProperty(newKPI)) {\n          newKPICount += 1;\n        }\n        else if(childDeviceData.hasOwnProperty('c8y_IsAsset')){\n          if (childDeviceData.childAssets.references.length > 0) {\n            const promises1 = childDeviceData.childAssets.references.map(async (assetChildDevice) => {\n            const assetChildInventory = await this.inventory.detail(assetChildDevice.managedObject.id);\n            const assetChildDeviceData = assetChildInventory.data;\n            if (assetChildDeviceData.hasOwnProperty(newKPI)) {\n              newKPICount += 1;\n            }\n            });\n            await Promise.all(promises1);\n          }\n        }\n      });\n      await Promise.all(promises);\n    }\n    else{\n      newKPICount = 0;\n    }\n    return newKPICount;\n  }\n\n  async getNewKPIValue(deviceId, newKPI){\n    let response: any = null;\n    let newKPIValue;\n    const inventory = await this.inventory.detail(deviceId);\n    response = inventory.data;\n    if (response.hasOwnProperty('c8y_IsDevice') && response.hasOwnProperty(newKPI)) {\n      newKPIValue = response[newKPI];\n    }\n    else if(response.childAssets.references.length > 0){\n      const promises = response.childAssets.references.map(async (childDevice) => {\n        const childInventory = await this.inventory.detail(childDevice.managedObject.id);\n        const childDeviceData = childInventory.data;\n        if (childDeviceData.hasOwnProperty(newKPI)) {\n          newKPIValue += response[newKPI];\n        }\n        else if(childDeviceData.hasOwnProperty('c8y_IsAsset')){\n          if (childDeviceData.childAssets.references.length > 0) {\n            const promises1 = childDeviceData.childAssets.references.map(async (assetChildDevice) => {\n            const assetChildInventory = await this.inventory.detail(assetChildDevice.managedObject.id);\n            const assetChildDeviceData = assetChildInventory.data;\n            if (assetChildDeviceData.hasOwnProperty(newKPI)) {\n              newKPIValue += response[newKPI];\n            }\n            });\n            await Promise.all(promises1);\n          }\n        }\n      });\n      await Promise.all(promises);\n    }\n    else{\n      newKPIValue = '';\n    }\n    return newKPIValue;\n  }\n}\n","/**\n * Copyright (c) 2020 Software AG, Darmstadt, Germany and/or its licensors\n *\n * SPDX-License-Identifier: Apache-2.0\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { AfterViewInit, Component, Input, OnDestroy, OnInit } from '@angular/core';\nimport * as _ from 'lodash';\nimport { GpKpiOverviewWidgetService } from './gp-kpi-overview-widget.service';\n\n\ninterface Device {\n  id: string;\n}\n\ninterface KPI {\n  default: {\n    color: string;\n    bgcolor: string\n  }\n  title: string;\n  icon: string;\n  topMargin: string;\n  color: string;\n  bgcolor: string;\n  unitColor: string;\n  titleColor: string;\n  messageColor: string;\n  value: any;\n  unit: string;\n  message: string;\n  kpiName: string;\n  otherKPIName: string;\n  otherKPIMetric: string;\n  titleSize: number;\n  messageSize: number;\n  kpiSize: number;\n  unitSize: number;\n  imageSize: number;\n  containerHeight: number;\n}\n\n@Component({\n  selector: 'lib-gp-kpi-overview-widget',\n  templateUrl: './gp-kpi-overview-widget.html',\n  styles: []\n})\nexport class GpKpiOverviewWidgetComponent implements OnInit, AfterViewInit{\n\n  @Input() config;\n\n  private device: Device = {\n    id: ''\n  }\n\n  private kpi: KPI = {\n    title: '',\n    topMargin: '',\n    icon: '',\n    value: 0,\n    unit: '',\n    color: '',\n    bgcolor: '',\n    unitColor: '',\n    titleColor: '',\n    messageColor: '',\n    otherKPIName: '',\n    otherKPIMetric: '',\n    kpiName: '',\n    message: '',\n    titleSize: 20,\n    messageSize: 10,\n    kpiSize: 30,\n    unitSize: 20,\n    imageSize: 60,\n    containerHeight: 80,\n    default: {\n      color: '',\n      bgcolor: ''\n    }\n  }\n\n  constructor(private kpiService: GpKpiOverviewWidgetService) { }\n\n  ngOnInit() {\n\n        // Get Device Id\n        this.device.id = _.get(this.config, 'device.id');\n        if(this.device.id === undefined || this.device.id.length === 0) {\n        }\n        // Get KPI Title\n        this.kpi.title = _.get(this.config, 'customwidgetdata.metadata.title');\n        if(this.kpi.title === undefined || this.kpi.title.length === 0) {\n          this.kpi.title = 'Default Title';\n        }\n        // Get KPI Name\n        this.kpi.kpiName = _.get(this.config, 'customwidgetdata.kpi.kpiName');\n        if(this.kpi.kpiName === undefined || this.kpi.kpiName.length === 0) {\n          this.kpi.kpiName = 'totalDevices';\n        }\n        // Get KPI Icon\n        this.kpi.icon = _.get(this.config, 'customwidgetdata.metadata.icon');\n        if(this.kpi.icon === undefined || this.kpi.icon.length === 0) {\n          this.kpi.icon = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAYAAACtWK6eAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEwAACxMBAJqcGAAADmlJREFUeJzt3XuwVWUZx/HvAygIAiEkaEh4i8wuZlJqN01r0mSyUnO66mSWWRY5OTpOt3FySsMarWzU1MlpMvPC5GUSK03UsqFESvECmlfIQJQEPHA4qz8WRw/Hvc9e71mX5117/T4z7z+bzTm/9e79nPXuvdb7viAiIiIiIiIiIiIiIiIijWPeAUSGaTIwBRgL9ABrgJVA4hlKxMsewOkYCzBWYSQt2jqMuzHOBd6DTgDSAIdj3N6mIDq1R4G5wDjvgxAp2l4Ytw6zMAa3p4BPeB+QSFFOxNhQUHEMbFcBE70PTmS4DGNeCYUxsP0TmO59oCLhjPNLLo7+thzYyftwRULMrag4+ttiYDvvgxbJYjbGxooLJMG4yPvARToZibHYoTjSBgd5d4DIUE5wK4603YMuKEqkRmAscy6QBDiifUARP4cAu3uHwPh8u39SgYgf41jvCFscBoxv9Q8qEPF0qHeALbahzYd1FYh4mQbM8A7xEmO/Vg+rQMTL670DDDKr1YMqEPEyzTvAIFNaPagCES/bewcYpGUeFYh4iW1q7IZWD6pAxMtz3gEGWdPqQRWIeHnMO8Agy1s9qAIRL0uBzd4hXpKwpNXDKhDxsg5Y7B1igFtbPagCEU83egfYYhHwZKt/UIGIn4RfEcO3WQm/9I4g0ppxk/Pt7qvQulkSsdkYfY5zQb7u3QEiQzMudiqQJcAo78MX6WQCxsMVF8c64A3eBy6S1d4Yz1VUHJuBj3gfsEioAzGeL7k4eoHjvA9UZLjejPHvkorjOYZYoEGkLiZR/FpZC4HdvA9MpAiG8VRBhfEg8CnvAxIp0gE5i+J50q0O5pDzbhF9ByzxMT4W8OwFwH3AWhIeAe4H7iGmO4VFCmUsz3im6AN29o4rUqV9AoZSd5YdRnfzSlyMj2Z+bsK1JSYRiZBxX+YzCMz0jitSpVkBw6u/VxFIQyyJiYZXIm0ZiwKGV7EtXSpSqhkBw6v7qgqlIZbEIvvwCg2vpGmM2wOGV/t4xxWp0lSMzRkLpOUKiGXREEticCTZ34vXlBlEJD7GzQHDq/2944pUaRLGxowF8iQV72muIZZ4m0O6iWYW1xLDSowilTHmBwyvDvKOK1KlcRjrMxbIM8DIqgNqiCWeDge2y/jc+TjMEtSU284mk+6Auh3QQ7pV10rXRN1Ccz9qaQ/gdIwFGKvanO7/h3EnxveA2d6Ba2o0xtqMw6s1ZP8gLyU5POh2h1fePHc8ehFDHBHQv9q/w9FeGLcOszAGt/uBg70PqBaMSwO+vfqwd9ymOhFjQ0HF0d/6MH6APt8NZeQQw9fB7QVgjHfgpjGMeQUXxuB2Pdm/oWma9wX041XeYZvHOL/k4uhvtwDbeh9udIyfBgyvPu4dt2nmVlQc/e0y7wOOTMi6uy8C23sHbpLZZL8xrrgGn/U+8IiErLv7O++wTTKS4pfUz9qeJb3YKMYP9YclTic4FUd/u8C7A6KQfd3djcAk77hNMQJjmXOBbACmeneEs5B1dxd4h4Xm3Kx4CLC7c4YxNH0jl7B7rzS1tjLGL5zPHv1tkXdXuMq+7u5mdLatkPFYBMXR/8Lv4N0dTkLW3b3dO2y/JgyxpgEzvENsMYLm3v1by+FVEwoktjVcZ3kHcJF9W7WEiFZObEKBTPMOsBWLLE81ZgBvy/jcRcATJWYJ0oQCie1WhfHeARzUcngFzSiQ2JaJiS1P+cJ2rVWBVOxZ7wBbSVjtHaFiU4EDMz53CbCsxCzBmlAgj3oHGOQR7wAVy77uboQLMzShQJaSrkYSi3u8A1Qq5Op5ZMOr5jBui+AiYYKxkorXlnUWsu7ug95hW2nCGQQS5ntH2GI+zfqQHrrurjjZEaPH/QzStKvoYevu7ucdt9lClpkpr12Aw/qyTsaRfcWYf3uHFZiJ8WIERXITzbhYeHRAn/zIO6ykvh1BgSQYS4jnBspyGL/O3B/wLu+4ktoG4+4ICiTBWAG83btDShKy7u4KmvJlUU1Mx3g6ggJJMNYDR3l3SAlC1t39mXdYGcy4JILi6G99wBneXVKosHV3D/WOK1vbG6M3gsIY3C6jO1ZhHEX2dXdXozWMIxOy5fDw2vM5/u9t1H9K7iEBx3upd1jZ2uElFsYK4DhgYs4ifAjY07ebcghbd/cI77jyslEYS0sojH8AXwLGDvpdF+b4mauB9/p0Uy4h6+6uBUZ7B+6kSeO/kwibn341sBrYDZhAegV8I7AKeJSExcBt0PIqcC8JJwEPYswj/GvMHTAWkPAF4PLA/+tpf2DnjM+9gbjusm60SRirA/6Cr6S4q91zSPc0HO7Z5Gzqcgdw2Lq7IbMMpVTGj4PelHBCwQn2wXgiR5H8ljpsxpN93d31bD0kFUezCNvyYDHlXNndCWNRjiK5m9hWaNlayLq7urU9Gsb1gWePMjfhHItxbY4ieQx4U4n5hs84K6CPP+kdV1LvD3wDVjGxyjDOyVEka4HDKsgZJvu6uz3ARO+4km6Y88+AN14PsEeF+U5g+Ltd9QJfqTBrJyHr7t7kHVZSXwx80/3QIeP7MNbkOJvEMgHrjIDh1ee8w0p6NfuZgDfaf/E77b+efJv7+E/Ayv7lQy/aii4CxrlBb7L0IqKnyRgLcxSJ5wSsGQE5/+SUUQbYnbAFGv5FHMOUbTGuyFEkXhOwvhbwh+hkh3yyldCvUeED3pEH+SZG3zCLpPoJWNnPfH1kvw1FSnJQ4BvqRu/AbRxL9hVBWr0Rq5qANRVjc8Zcd1WUSdoYgXFPwBtpE/FtrjPQARj/yTHkqmIC1hcCztSnlpxFOvhc4BvofO/AGczE+FeOIrmNMidghcx7gZml5ZCOtsdYEfDGWU19Zu5NCHojvrKVNQErZN3df5Tw+yUz4+ygNw2c4h05UIwTsD4T0N9nFvy7JcBrCftAu5T6ThT7Gtk/FA9uPaRTgosRtu5uzJ/1upzxm8Czx4e8I+cUwwSskHV37y/ioGV43hn45rjZO3BBvCdghay7e1ZRBy1hDONvAS9UL7C3d+gC+U3AClt3d59Cj1oy+3TgG+JC78AlKHMClgHvAL6FcQPGw6RDu5Cr/Mur6woZaCzGkwEv1HN0712kRU/AGgecivFIjp/Z38516pOGM74T9EI14ypuEROwjqHIhb3TZYCkYtMx1gW8UA/THWveZpF3AlaxDU6jLksWdY3QW8LTfbqbJO8ErKLb1cAY705pircT9iGxqRN08k7AKrr9kTqs61V7xp0BL8pm4C3ekR3lnYBVdLsGDbdKdWzgC3KJd+BI5JmAVWyDb3h3Rrcag/FYwIuxFpjqHToieSZgFdleBGZ5d0Y3OjPwL1V3bWlWjLwTsIpq13t3RLfZibCb8x6lBvtOOJlJ9gWmyxxq7evdEd0jZEPItPOP9o4csVFk3+CmzHaxd0d0i30Jm/+w0Dtw5A6LoDgSjDXUd05ORIw/B3R6H7Cfd+SoGT+PoDj6z/Tv8u6OLMrYB6MoHwPeE/D8K4BFJWXpFiH9WTbdp5XDaMI+TL6AFiXrZHTgcLXsVostoGM9g3yVdPPMbBLOAZ4uLU13mE5cr/d07wB1tSPG8wF/iR5H9/lk8dYIzhoD21+9OySLmP6ipNI5zBMyPz/hDGBDaXm6x2bvAIPElqcW3oTRG/BX6C/oBrisdo3grDGw/d67Q7KI6wxinEf2rQgSEuYCSYmJusnTQJ93iAEe9w6QRUwFMgc4NOD5V0I9xrGR6AEe8Q7xkoQHvCPUyTYYDwacntcDu3iHrh3j8giGVmnz2ewnWCxnkJOB1wU8fx7wRElZulcSzcJ5q4G/e4eoi8kYzwb89XmKdGkaCTeWfMuWFtV+4t0R9WFcEHhqPs47cq0Z5zsXRx/dtcJlqfbC2BTQuYvQ17p57YLv7MKrvTugPoybAs8e7/aO3BVCF94rrq0H7TSV1QcDO/e33oG7yGjC9nMspqWrN0oGozDuC+jcF4FdvUN3mT0xVldYIFd6H3CdnBzYud/3Dtyl9qeab7X+gNYJyOxVGKsCOnclMN47dBebjfFMicVxLVp6NIBxXuC49fPekRtgF4w7Ci6MXtLNO2v9rWPR4Q2YSXpVfAowlvRq/TrSm9P+R7qz0TYZf969JOxLXDfZdasRwEmk0w0m5fxZd5DwZeDe/LHqbwzpyn1XBw6dspw9DvY+uAYaD5xGuqNUyOu1CeNGwm447WrjSbfnKrYoXm7zvQ9Q2A84HeM6jPtJbwnahLEeYyXGXaRrIH8a2NE5a1SOosidiF7ZeoA9vA9SJNS2GBeVWBj9bZ73gYqE2h7jlgqK47/ARO+DFYHs80G2xbiOaj6ArULTaKVWqhlWDWzXU/Pvz6U5jqq4ONIGp3gfuEgn4yn326qh2gto9T1x1ukzyFxgpyqCtDAO47tOv1sEGHqcPwbjSWByVWFa2ETCrsBTjhmkwYY6gxyJb3FAes/W8c4ZpMHaF4hxVIU52jOO8Y4gzdVuiGVbLth5n0FSCTsDK7xjSPO0O4PMJJbiSNViFT7pPu0KJGSVwyrElkcaol2BTKk0RSfGNO8I0kztCiS2HZs0p1lctCuQnkpTdLbeO4A0U7sCWVNpik6SyPJIY7QrkGWVpuhsuXcAaaahCmRdlUE6WOIdQJqpXYH0AndWGWQIK4Gl3iGkmdrfapJEs6pILDlEtrIDvvtI9E+cOsC7I0RaM37qXCALvbtAZCivwXNPO3ivdweIdHKqU4Fc4X3gIlmMoJr1sAa2ZcAE7wMXyWoyxgMVFcezaBdUqaEZGA9VUBz61kpq69UUv9FKf1sOvNH7AEXyGoVxFsbGgj+Qaz1e6Sp7kW6a05ejMBair3Kly83COJvsOxKtwLgQfdaQGih6gehdgH2B12FMAcYBG0jncywn3bPugYJ/p4iIiIiIiIiIiIiIiIiISHH+DxoECITLjQoBAAAAAElFTkSuQmCC';\n        }\n        // Get KPI Message\n        this.kpi.message = _.get(this.config, 'customwidgetdata.kpi.message');\n        if(this.kpi.message === undefined || this.kpi.message.length === 0) {\n          this.kpi.message = '';\n        }\n        // Get KPI Color\n        this.kpi.default.color = _.get(this.config, 'customwidgetdata.kpi.color');\n        if(this.kpi.default.color === undefined || this.kpi.default.color.indexOf('#') !== 0) {\n          this.kpi.default.color = '#b0b0b0';\n        }\n        this.kpi.color = this.kpi.default.color;\n        // Get Bg KPI Color\n        this.kpi.default.bgcolor = _.get(this.config, 'customwidgetdata.kpi.bgcolor');\n        if(this.kpi.default.bgcolor === undefined || this.kpi.default.bgcolor.indexOf('#') !== 0) {\n          this.kpi.default.bgcolor = '#FFFFFF';\n        }\n        this.kpi.bgcolor = this.kpi.default.bgcolor;\n\n        // Get Title Color\n        this.kpi.titleColor = _.get(this.config, 'customwidgetdata.kpi.titleColor');\n        if(this.kpi.titleColor === undefined || this.kpi.titleColor.indexOf('#') !== 0) {\n          this.kpi.titleColor = '#b0b0b0';\n        }\n\n        // Get Unit Color\n        this.kpi.unitColor = _.get(this.config, 'customwidgetdata.kpi.unitColor');\n        if(this.kpi.unitColor === undefined || this.kpi.unitColor.indexOf('#') !== 0) {\n          this.kpi.unitColor = '#b0b0b0';\n        }\n\n        // Get message Color\n        this.kpi.messageColor = _.get(this.config, 'customwidgetdata.kpi.messageColor');\n        if(this.kpi.messageColor === undefined || this.kpi.messageColor.indexOf('#') !== 0) {\n          this.kpi.messageColor = '#808080';\n        }\n        // Get KPI Unit\n        this.kpi.unit = _.get(this.config, 'customwidgetdata.kpi.unit');\n        this.kpi.titleSize = _.get(this.config, 'customwidgetdata.kpi.titleSize');\n        this.kpi.kpiSize = _.get(this.config, 'customwidgetdata.kpi.kpiSize');\n        this.kpi.unitSize = _.get(this.config, 'customwidgetdata.kpi.unitSize');\n        this.kpi.messageSize = _.get(this.config, 'customwidgetdata.kpi.messageSize');\n        this.kpi.imageSize = _.get(this.config, 'customwidgetdata.kpi.imageSize');\n        this.kpi.value = null;\n        this.getDeviceData();\n  }\n\n  ngAfterViewInit() {\n    this.configureTopMarginRequired();\n  }\n\n    // Configure top margin within the widget. This is on the basis if the Widget title is set to hidden or not.\n    private configureTopMarginRequired(): void {\n      const allWidgets: NodeListOf<Element> = document.querySelectorAll('.dashboard-grid-child');\n        allWidgets.forEach((w:Element) => {\n          const widgetElement: Element = w.querySelector('div > div > div > c8y-dynamic-component > lib-gp-kpi-overview-widget');\n          if(widgetElement !== undefined && widgetElement !== null) {\n            const widgetTitleElement: Element = w.querySelector('div > div > div > c8y-dashboard-child-title');\n            const widgetTitleDisplayValue: string = window.getComputedStyle(widgetTitleElement).getPropertyValue('display');\n            if(widgetTitleDisplayValue !== undefined && widgetTitleDisplayValue !== null && widgetTitleDisplayValue === 'none') {\n              this.kpi.topMargin = '25px';\n            } else {\n              this.kpi.topMargin = '0';\n            }\n          }\n        });\n    }\n  async getDeviceData() {\n    if (this.kpi.kpiName !== null && this.kpi.kpiName !== '') {\n\n        if (this.kpi.kpiName === 'totalDevices'){\n         const result = await this.kpiService.getDevicesAvailability(this.device.id);\n          if (result) {\n            this.kpi.value = result.totalDevices;\n          }\n        }\n        else if (this.kpi.kpiName === 'available') {\n          const result = await this.kpiService.getDevicesAvailability(this.device.id);\n          if (result) {\n            this.kpi.value = result.availableDevices;\n          }\n        }\n        else if (this.kpi.kpiName === 'unavailable') {\n          const result = await this.kpiService.getDevicesAvailability(this.device.id);\n          if (result) {\n            this.kpi.value = result.unavailableDevices;\n          }\n        }\n        else if (this.kpi.kpiName === 'totalAlarms') {\n          const result = await this.kpiService.getAlarms(this.device.id);\n          if (result) {\n            this.kpi.value = result.totalAlarms;\n          }\n        }\n        else if (this.kpi.kpiName === 'major') {\n          const result = await this.kpiService.getAlarms(this.device.id);\n          if (result) {\n            this.kpi.value = result.majorAlertsCount;\n          }\n        }\n        else if (this.kpi.kpiName === 'minor') {\n          const result = await this.kpiService.getAlarms(this.device.id);\n          if (result) {\n            this.kpi.value = result.minorAlertsCount;\n          }\n        }\n        else if (this.kpi.kpiName === 'critical') {\n          const result = await this.kpiService.getAlarms(this.device.id);\n          if (result) {\n            this.kpi.value = result.criticalAlertsCount;\n          }\n        }\n        else if (this.kpi.kpiName === 'highRisk') {\n          const result = await this.kpiService.getFirmwareRisks(this.device.id);\n          if (result) {\n            this.kpi.value = result.highRiskCount;\n          }\n        }\n        else if (this.kpi.kpiName === 'mediumRisk') {\n          const result = await this.kpiService.getFirmwareRisks(this.device.id);\n          if (result) {\n            this.kpi.value = result.mediumRiskCount;\n          }\n        }\n        else if (this.kpi.kpiName === 'lowRisk') {\n          const result = await this.kpiService.getFirmwareRisks(this.device.id);\n          if (result) {\n            this.kpi.value = result.lowRiskCount;\n          }\n        }\n        else if (this.kpi.kpiName === 'noRisk') {\n          const result = await this.kpiService.getFirmwareRisks(this.device.id);\n          if (result) {\n            this.kpi.value = result.noRiskCount;\n          }\n        }\n        else if (this.kpi.kpiName === 'other') {\n\n          if (this.kpi.otherKPIMetric === 'value') {\n            const result = await this.kpiService.getNewKPIValue(this.device.id, this.kpi.otherKPIName);\n            if (result) {\n              this.kpi.value = result;\n            }\n          }\n          else if(this.kpi.otherKPIMetric === 'count') {\n            const result = await this.kpiService.getNewKPICount(this.device.id, this.kpi.otherKPIName);\n            if (result) {\n              this.kpi.value = result;\n            }\n          }\n        }\n        else{\n          this.kpi.value = 0;\n        }\n    }\n  }\n      // Getter KPI Title\n  public getKPITitle(): string {\n    return this.kpi.title;\n  }\n  // Getter KPI Title Top Margin\n  public getKPITitleTopMargin() {\n    return this.kpi.topMargin;\n  }\n  // Getter KPI Icon\n  public getKPIIcon(): string {\n    return this.kpi.icon;\n  }\n  // Get KPI Container Height\n  public getKPIContainerHeight(): string {\n      return '90px';\n  }\n  // Getter KPI Value\n  public getKPIValue() {\n    return this.kpi.value;\n  }\n  // Getter KPI Unit\n  public getKPIUnit() {\n    return this.kpi.unit;\n  }\n  // Getter KPI Name\n  public getKPIName() {\n    return this.kpi.kpiName;\n  }\n  // Getter KPI Color\n  public getKPIColor() {\n    return this.kpi.color;\n  }\n  // Getter Title Color\n  public getTitleColor() {\n    return this.kpi.titleColor;\n  }\n  // Getter Unit Color\n  public getUnitColor() {\n    return this.kpi.unitColor;\n  }\n  // Getter Message Color\n  public getMessageColor() {\n    return this.kpi.messageColor;\n  }\n  // Getter KPI background Color\n  public getKPIBgColor() {\n    return this.kpi.bgcolor;\n  }\n  // Getter Other KPI Name\n  public getOtherKPIName() {\n    return this.kpi.otherKPIName;\n  }\n  // Getter Other KPI metric\n  public getOtherKPIMetric() {\n    return this.kpi.otherKPIMetric;\n  }\n    // Getter Other KPI Message\n  public getKPIMessage() {\n    return this.kpi.message;\n  }\n  public getKPISize() {\n    return this.kpi.kpiSize + 'px';\n  }\n  public getTitleSize() {\n    return this.kpi.titleSize + 'px';\n  }\n  public getMessageSize() {\n    return this.kpi.messageSize + 'px';\n  }\n  public getUnitSize() {\n    return this.kpi.unitSize + 'px';\n  }\n  public getImageSize() {\n    return this.kpi.imageSize + 'px';\n  }\n\n  public getContainerHeight(){\n      if (this.kpi.imageSize > this.kpi.titleSize && this.kpi.imageSize > this.kpi.kpiSize) {\n        this.kpi.containerHeight = this.kpi.imageSize + 10;\n     } else if(this.kpi.titleSize > this.kpi.kpiSize){\n        this.kpi.containerHeight = this.kpi.titleSize + 10;\n    }else{\n      this.kpi.containerHeight = this.kpi.kpiSize + 10;\n    }\n    return this.kpi.containerHeight + 'px';\n  }\n}\n","\r\n\r\n/*\r\n* Copyright (c) 2020 Software AG, Darmstadt, Germany and/or its licensors\r\n*\r\n* SPDX-License-Identifier: Apache-2.0\r\n*\r\n* Licensed under the Apache License, Version 2.0 (the \"License\");\r\n* you may not use this file except in compliance with the License.\r\n* You may obtain a copy of the License at\r\n*\r\n*    http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing, software\r\n* distributed under the License is distributed on an \"AS IS\" BASIS,\r\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n* See the License for the specific language governing permissions and\r\n* limitations under the License.\r\n */\r\n\r\nimport { Component, Input, OnInit } from '@angular/core';\r\nimport * as _ from 'lodash';\r\n\r\n@Component({\r\n  selector: 'lib-gp-kpi-overview-widget-config',\r\n  templateUrl: './gp-kpi-overview-widget-config.html',\r\n  styleUrls: ['./gp-kpi-overview-widget-config.css']\r\n})\r\nexport class GpKpiOverviewWidgetConfigComponent implements OnInit {\r\n  @Input() config: any = {};\r\n  kpiColorPickerClosed = true;\r\n  kpiBgColorPickerClosed = true;\r\n  titleColorPickerClosed = true;\r\n  kpiUnitColorPickerClosed = true;\r\n  messageColorPickerClosed = true;\r\n\r\n\r\n\r\n  widgetInfo = {\r\n    metadata: {\r\n      title: '',\r\n      icon: '',\r\n    },\r\n    kpi: {\r\n      color: '#b0b0b0',\r\n      unit: '',\r\n      bgcolor: '#FFFFFF',\r\n      kpiName: '',\r\n      message: '',\r\n      otherKPIValue: '',\r\n      otherKPIName: '',\r\n      titleColor: '#808080',\r\n      unitColor: '#b0b0b0',\r\n      messageColor: '#808080',\r\n      titleSize: 20,\r\n      messageSize: 10,\r\n      unitSize: 20,\r\n      kpiSize: 30,\r\n      imageSize: 60,\r\n\r\n  }\r\n}\r\nkpiNamesList = [\r\n    {\r\n      id: 'totalDevices',\r\n      text: 'Total Devices'\r\n    },\r\n    {\r\n      id: 'available',\r\n      text: 'Available Devices'\r\n    },\r\n    {\r\n      id: 'unavailable',\r\n      text: 'Unavailable Devices'\r\n    },\r\n    {\r\n      id: 'totalAlarms',\r\n      text: 'Total Alarms'\r\n    },\r\n    {\r\n      id: 'major',\r\n      text: 'Major Alarms'\r\n    },\r\n    {\r\n      id: 'minor',\r\n      text: 'Minor Alarms'\r\n    },\r\n    {\r\n      id: 'critical',\r\n      text: 'Critical Alarms'\r\n    },\r\n    {\r\n      id: 'highRisk',\r\n      text: 'High Risk'\r\n    }\r\n    ,\r\n    {\r\n      id: 'mediumRisk',\r\n      text: 'Medium Risk'\r\n    },\r\n    {\r\n      id: 'lowRisk',\r\n      text: 'Low Risk'\r\n    },\r\n    {\r\n      id: 'noRisk',\r\n      text: 'No Risk'\r\n    },\r\n    {\r\n      id: 'other',\r\n      text: 'Other Property'\r\n    }\r\n\r\n  ];\r\n  constructor() {}\r\n\r\n  async ngOnInit() {\r\n    // Editing an existing widget\r\n    if(_.has(this.config, 'customwidgetdata')) {\r\n      this.widgetInfo = _.get(this.config, 'customwidgetdata');\r\n    } else { // Adding a new widget\r\n      _.set(this.config, 'customwidgetdata', this.widgetInfo);\r\n    }\r\n  }\r\n\r\n  public updateIconInConfig($event: Event) {\r\n    const kpiIcon = ($event.target as HTMLInputElement).files[0];\r\n    const reader = new FileReader();\r\n    reader.readAsDataURL(kpiIcon);\r\n    reader.onload = () => {\r\n        this.widgetInfo.metadata.icon = reader.result as string;\r\n        _.set(this.config, 'customwidgetdata', this.widgetInfo);\r\n    };\r\n  }\r\n\r\n  public updateConfig() {\r\n\r\n    _.set(this.config, 'customwidgetdata', this.widgetInfo);\r\n  }\r\n\r\n\r\n  setSelectedColorForKPI(value: string) {\r\n    this.widgetInfo.kpi.color = value;\r\n    this.updateConfig();\r\n  }\r\n\r\n  closeKPIColorPicker() {\r\n    this.kpiColorPickerClosed = true;\r\n  }\r\n\r\n  openKPIColorPicker() {\r\n    this.kpiColorPickerClosed = false;\r\n  }\r\n\r\n  setSelectedColorForTitle(value: string) {\r\n    this.widgetInfo.kpi.titleColor = value;\r\n    this.updateConfig();\r\n  }\r\n\r\n  closeTitleColorPicker() {\r\n    this.titleColorPickerClosed = true;\r\n  }\r\n\r\n  openTitleColorPicker() {\r\n    this.titleColorPickerClosed = false;\r\n  }\r\n\r\n  setSelectedColorForKPIUnit(value: string) {\r\n    this.widgetInfo.kpi.unitColor = value;\r\n    this.updateConfig();\r\n  }\r\n\r\n  closeKPIUnitColorPicker() {\r\n    this.kpiUnitColorPickerClosed = true;\r\n  }\r\n\r\n  openKPIUnitColorPicker() {\r\n    this.kpiUnitColorPickerClosed = false;\r\n  }\r\n\r\n  setSelectedColorForMessage(value: string) {\r\n    this.widgetInfo.kpi.messageColor = value;\r\n    this.updateConfig();\r\n  }\r\n\r\n  closeMessageColorPicker() {\r\n    this.messageColorPickerClosed = true;\r\n  }\r\n\r\n  openMessageColorPicker() {\r\n    this.messageColorPickerClosed = false;\r\n  }\r\n\r\n\r\n  closeKPIBgColorPicker() {\r\n    this.kpiBgColorPickerClosed = true;\r\n  }\r\n\r\n  openKPIBgColorPicker() {\r\n    this.kpiBgColorPickerClosed = false;\r\n  }\r\n\r\n  setSelectedColorForBackground(value: string) {\r\n    this.widgetInfo.kpi.bgcolor = value;\r\n    this.updateConfig();\r\n  }\r\n\r\n}","/**\n * Copyright (c) 2020 Software AG, Darmstadt, Germany and/or its licensors\n *\n * SPDX-License-Identifier: Apache-2.0\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport {\n  Component,\n  Output,\n  EventEmitter,\n  HostListener,\n  ElementRef,\n} from '@angular/core';\n\n@Component({\n  // tslint:disable-next-line: component-selector\n  selector: 'app-color-picker',\n  templateUrl: './color-picker-component.html',\n  styleUrls: ['./color-picker-component.css'],\n})\nexport class ColorPickerComponent {\n  @Output() colorSet: EventEmitter<string> = new EventEmitter(true);\n  @Output() colorPickerClosed: EventEmitter<boolean> = new EventEmitter();\n\n  public hue: string;\n  public color: string;\n  public colorType: any = 'hexa';\n  constructor(private eRef: ElementRef) {}\n\n  closeColorPicker(): void {\n    this.colorPickerClosed.emit(true);\n  }\n  applyColorClicked(): void {\n    if (this.color !== undefined) {\n      if (this.colorType === 'hexa') {\n        this.colorSet.emit(this.RGBAToHexA(this.color));\n      } else {\n        this.colorSet.emit(this.color);\n      }\n    }\n  }\n\n  RGBAToHexA(rgba) {\n    const sep = rgba.indexOf(',') > -1 ? ',' : ' ';\n    rgba = rgba.substr(5).split(')')[0].split(sep);\n\n    // Strip the slash if using space-separated syntax\n    if (rgba.indexOf('/') > -1) { rgba.splice(3, 1); }\n\n    let r = (+rgba[0]).toString(16);\n    let g = (+rgba[1]).toString(16);\n    let  b = (+rgba[2]).toString(16);\n    let  a = Math.round(+rgba[3] * 255).toString(16);\n\n    if (r.length === 1) { r = '0' + r; }\n    if (g.length === 1) { g = '0' + g; }\n    if (b.length === 1) { b = '0' + b; }\n    if (a.length === 1) { a = '0' + a; }\n\n    return '#' + r + g + b + a;\n  }\n}\n","/**\n * Copyright (c) 2020 Software AG, Darmstadt, Germany and/or its licensors\n *\n * SPDX-License-Identifier: Apache-2.0\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport {\n  Component,\n  ElementRef,\n  ViewChild,\n  HostListener,\n  Output,\n  EventEmitter,\n} from '@angular/core';\n\n@Component({\n  // tslint:disable-next-line: component-selector\n  selector: 'app-color-slider',\n  templateUrl: './color-slider-component.html',\n})\nexport class ColorSliderComponent {\n  @Output()\n  color: EventEmitter<string> = new EventEmitter(true);\n\n  @ViewChild('canvas', { static: true })\n  canvas: ElementRef<HTMLCanvasElement>;\n\n  private ctx: CanvasRenderingContext2D;\n  private mousedown = false;\n  private selectedHeight: number;\n\n  // tslint:disable-next-line: use-lifecycle-interface\n  ngAfterViewInit() {\n    this.draw();\n  }\n  onMouseDown(evt: MouseEvent) {\n    this.mousedown = true;\n    this.selectedHeight = evt.offsetY;\n    this.draw();\n    this.emitColor(evt.offsetX, evt.offsetY);\n  }\n  onMouseMove(evt: MouseEvent) {\n    if (this.mousedown) {\n      this.selectedHeight = evt.offsetY;\n      this.draw();\n      this.emitColor(evt.offsetX, evt.offsetY);\n    }\n  }\n  @HostListener('window:mouseup', ['$event'])\n  onMouseUp(evt: MouseEvent) {\n    this.mousedown = false;\n  }\n  emitColor(x: number, y: number) {\n    const rgbaColor = this.getColorAtPosition(x, y);\n    this.color.emit(rgbaColor);\n  }\n  getColorAtPosition(x: number, y: number) {\n    const imageData = this.ctx.getImageData(x, y, 1, 1).data;\n    return (\n      'rgba(' + imageData[0] + ',' + imageData[1] + ',' + imageData[2] + ',1)'\n    );\n  }\n  draw() {\n    if (!this.ctx) {\n      this.ctx = this.canvas.nativeElement.getContext('2d');\n    }\n\n    const width = this.canvas.nativeElement.width;\n    const height = this.canvas.nativeElement.height;\n    this.ctx.clearRect(0, 0, width, height);\n\n    const gradient = this.ctx.createLinearGradient(0, 0, 0, height);\n    gradient.addColorStop(0, 'rgba(255, 0, 0, 1)');\n    gradient.addColorStop(0.17, 'rgba(255, 255, 0, 1)');\n    gradient.addColorStop(0.34, 'rgba(0, 255, 0, 1)');\n    gradient.addColorStop(0.51, 'rgba(0, 255, 255, 1)');\n    gradient.addColorStop(0.68, 'rgba(0, 0, 255, 1)');\n    gradient.addColorStop(0.85, 'rgba(255, 0, 255, 1)');\n    gradient.addColorStop(1, 'rgba(255, 0, 0, 1)');\n\n    this.ctx.beginPath();\n    this.ctx.rect(0, 0, width, height);\n    this.ctx.fillStyle = gradient;\n    this.ctx.fill();\n    this.ctx.closePath();\n\n    if (this.selectedHeight) {\n      this.ctx.beginPath();\n      this.ctx.strokeStyle = 'white';\n      this.ctx.lineWidth = 5;\n      this.ctx.rect(0, this.selectedHeight - 5, width, 10);\n      this.ctx.stroke();\n      this.ctx.closePath();\n    }\n  }\n}\n","/**\n * Copyright (c) 2020 Software AG, Darmstadt, Germany and/or its licensors\n *\n * SPDX-License-Identifier: Apache-2.0\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  Component,\n  ViewChild,\n  ElementRef,\n  AfterViewInit,\n  Input,\n  Output,\n  SimpleChanges,\n  OnChanges,\n  EventEmitter,\n  HostListener,\n} from '@angular/core';\n\n@Component({\n  // tslint:disable-next-line: component-selector\n  selector: 'app-color-palette',\n  templateUrl: './color-palette-component.html',\n  styleUrls: ['./color-palette-component.css'],\n})\nexport class ColorPaletteComponent implements AfterViewInit, OnChanges {\n  @Input()\n  hue: string;\n\n  @Output()\n  color: EventEmitter<string> = new EventEmitter(true);\n\n  @ViewChild('canvas', { static: true })\n  canvas: ElementRef<HTMLCanvasElement>;\n\n  private ctx: CanvasRenderingContext2D;\n\n  private mousedown = false;\n\n  public selectedPosition: { x: number; y: number };\n\n  ngAfterViewInit() {\n    this.draw();\n  }\n\n  draw() {\n    if (!this.ctx) {\n      this.ctx = this.canvas.nativeElement.getContext('2d');\n    }\n    const width = this.canvas.nativeElement.width;\n    const height = this.canvas.nativeElement.height;\n\n    this.ctx.fillStyle = this.hue || 'rgba(255,255,255,1)';\n    this.ctx.fillRect(0, 0, width, height);\n\n    const whiteGrad = this.ctx.createLinearGradient(0, 0, width, 0);\n    whiteGrad.addColorStop(0, 'rgba(255,255,255,1)');\n    whiteGrad.addColorStop(1, 'rgba(255,255,255,0)');\n\n    this.ctx.fillStyle = whiteGrad;\n    this.ctx.fillRect(0, 0, width, height);\n\n    const blackGrad = this.ctx.createLinearGradient(0, 0, 0, height);\n    blackGrad.addColorStop(0, 'rgba(0,0,0,0)');\n    blackGrad.addColorStop(1, 'rgba(0,0,0,1)');\n\n    this.ctx.fillStyle = blackGrad;\n    this.ctx.fillRect(0, 0, width, height);\n\n    if (this.selectedPosition) {\n      this.ctx.strokeStyle = 'white';\n      this.ctx.fillStyle = 'white';\n      this.ctx.beginPath();\n      this.ctx.arc(\n        this.selectedPosition.x,\n        this.selectedPosition.y,\n        10,\n        0,\n        2 * Math.PI\n      );\n      this.ctx.lineWidth = 5;\n      this.ctx.stroke();\n    }\n  }\n\n  ngOnChanges(changes: SimpleChanges) {\n    // tslint:disable-next-line: no-string-literal\n    if (changes['hue']) {\n      this.draw();\n      const pos = this.selectedPosition;\n      if (pos) {\n        this.color.emit(this.getColorAtPosition(pos.x, pos.y));\n      }\n    }\n  }\n\n  @HostListener('window:mouseup', ['$event'])\n  onMouseUp(evt: MouseEvent) {\n    this.mousedown = false;\n  }\n\n  onMouseDown(evt: MouseEvent) {\n    this.mousedown = true;\n    this.selectedPosition = { x: evt.offsetX, y: evt.offsetY };\n    this.draw();\n    this.color.emit(this.getColorAtPosition(evt.offsetX, evt.offsetY));\n  }\n\n  onMouseMove(evt: MouseEvent) {\n    if (this.mousedown) {\n      this.selectedPosition = { x: evt.offsetX, y: evt.offsetY };\n      this.draw();\n      this.emitColor(evt.offsetX, evt.offsetY);\n    }\n  }\n\n  emitColor(x: number, y: number) {\n    const rgbaColor = this.getColorAtPosition(x, y);\n    this.color.emit(rgbaColor);\n  }\n\n  getColorAtPosition(x: number, y: number) {\n    const imageData = this.ctx.getImageData(x, y, 1, 1).data;\n    return (\n      'rgba(' + imageData[0] + ',' + imageData[1] + ',' + imageData[2] + ',1)'\n    );\n  }\n}\n","/**\n * Copyright (c) 2020 Software AG, Darmstadt, Germany and/or its licensors\n *\n * SPDX-License-Identifier: Apache-2.0\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { NgModule } from '@angular/core';\nimport { CommonModule, CoreModule, HOOK_COMPONENTS } from '@c8y/ngx-components';\nimport { GpKpiOverviewWidgetComponent } from './gp-kpi-overview-widget.component';\nimport * as preview from './preview-image';\nimport { GpKpiOverviewWidgetConfigComponent } from './gp-kpi-overview-widget-config/gp-kpi-overview-widget-config.component';\nimport { GpKpiOverviewWidgetService } from './gp-kpi-overview-widget.service';\nimport { NgSelectModule } from '@ng-select/ng-select';\nimport { FormsModule } from '@angular/forms';\nimport { ColorPickerComponent } from './color-picker/color-picker-component';\nimport { ColorSliderComponent } from './color-picker/color-slider/color-slider-component';\nimport { ColorPaletteComponent } from './color-picker/color-palette/color-palette-component';\n@NgModule({\n  declarations: [\n    GpKpiOverviewWidgetComponent,\n    GpKpiOverviewWidgetConfigComponent,\n    ColorPickerComponent,\n    ColorSliderComponent,\n    ColorPaletteComponent\n  ],\n  imports: [\n    NgSelectModule,\n    FormsModule,\n    CommonModule,\n    CoreModule\n  ],\n  exports: [GpKpiOverviewWidgetComponent, GpKpiOverviewWidgetConfigComponent],\n  entryComponents: [GpKpiOverviewWidgetComponent, GpKpiOverviewWidgetConfigComponent],\n\n  providers: [\n    GpKpiOverviewWidgetService,\n    {\n    provide: HOOK_COMPONENTS,\n    multi: true,\n    useValue: {\n        id: 'kpi-overview.widget',\n        label: 'KPI Overview',\n        previewImage: preview.previewImage,\n        description: 'KPI Overview',\n        component: GpKpiOverviewWidgetComponent,\n        configComponent: GpKpiOverviewWidgetConfigComponent,\n        data: {\n            ng1: {\n                options: {\n                noDeviceTarget: false,\n                noNewWidgets: false,\n                deviceTargetNotRequired: false,\n                groupsSelectable: true\n                }\n            }\n        }\n    }\n    }],\n})\nexport class GpKpiOverviewWidgetModule { }\n"],"sourceRoot":""}